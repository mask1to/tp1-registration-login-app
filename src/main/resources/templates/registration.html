<!DOCTYPE html>
<html xmlns:th="http://www.w3.org/1999/xhtml">
<head th:replace="includes/header :: header"/>
<body>

<div th:replace="includes/navbar :: navbar"/>

<section class="pt-4">
    <div class="container">
        <div class="row">
            <div class="col-md-6 col-md-offset-3">

                <div class="alert alert-danger" role="alert" th:text="${error}" th:if="${error}"></div>

                <h1>Registration</h1>

                <form th:action="@{/registration}" method="post" th:object="${user}">
                    <input type="hidden" th:value="${token}" th:name="token">
                    <div th:if="${reg}">
                        <div class="form-group">
                            <label class="control-label" for="firstName"> First Name </label>
                            <input id="firstName" type="text" class="form-control" th:field="*{firstName}" th:errorClass="is-invalid"
                                   required/>
                            <div th:if="${#fields.hasErrors('firstName')}" th:errors="*{firstName}" class="invalid-feedback"></div>
                            <div class="alert alert-danger" role="alert" th:text="${error1}" th:if="${error1}"></div>
                        </div>


                        <div class="form-group">
                            <label class="control-label" for="lastName"> Last Name </label>
                            <input id="lastName" type="text" class="form-control" th:field="*{lastName}" th:errorClass="is-invalid"
                                   required/>
                            <div th:if="${#fields.hasErrors('lastName')}" th:errors="*{lastName}" class="invalid-feedback"></div>
                            <div class="alert alert-danger" role="alert" th:text="${error2}" th:if="${error2}"></div>
                        </div>


                        <div class="form-group">
                            <label class="control-label" for="email"> Email </label>
                            <input id="email" type="email" class="form-control" th:value="${email}" th:name="email" th:errorClass="is-invalid"
                                   readonly/>
                            <div th:if="${#fields.hasErrors('email')}" th:errors="*{email}" class="invalid-feedback"></div>
                            <div class="alert alert-danger" role="alert" th:text="${erro3}" th:if="${error3}"></div>
                        </div>

                        <div class="form-group">
                            <label class="control-label" for="phoneNumber"> Phone number </label>
                            <div class="d-flex align-items-center justify-content-between">
                                <input id="phoneNumber" type="text" class="form-control d-inline-block"
                                       th:value="${phoneNumber}" th:errorClass="is-invalid" th:name="phoneNumber"/>
                            </div>
                            <div th:if="${#fields.hasErrors('phoneNumber')}" th:errors="*{phoneNumber}" class="invalid-feedback"></div>
                            <div class="alert alert-danger" role="alert" th:text="${error5}" th:if="${error5}"></div>
                        </div>

                        <div class="form-group">
                            <label class="control-label" for="password"> Password </label>
                            <input id="password" type="password" class="form-control" th:field="*{password}"
                                   required/>
                            <div class="alert alert-danger" role="alert" th:text="${error4}" th:if="${error4}"></div>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-success"
                                    onclick="window.open('https://recognition-service-be.herokuapp.com/#/?mode=2&user=' + document.getElementById('email').value,'_blank')"
                                    name="registerFace" type="button">Register face
                            </button>
                        </div>

                        <div class="form-group">
                            <label class="control-label" for="Usingfa">Do you want to use 2FA?</label>
                            <select id="Usingfa" class="custom-select" th:field="*{Usingfa}" required
                                    autofocus="autofocus">
                                <option value="true">Yes</option>
                                <option value="false">No</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <button type="submit" name="register" class="btn btn-success">Register</button>
                            <span>Already registered? <a href="/" th:href="@{/login}">Login here</a></span>
                        </div>
                    </div>
                    <div th:if="${gaReg}">
                        <div>
                            <p>Please install and register to Authy app
                                <a href="https://play.google.com/store/apps/details?id=com.authy.authy">Android</a>
                                and
                                <a href="https://itunes.apple.com/us/app/authy/id494168017">iPhone</a>
                            </p>
                            <br/>
                        </div>
                        <div class="form-group">
                            <button type="submit" name="registerGa" class="btn btn-success">Finish registration</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
        crossorigin="anonymous"></script>
</body>
</html>

<script type="text/javascript">
    function openFace() {
        var email = document.getElementById('email');
        window.open('https://recognition-service-be.herokuapp.com/#/?mode=1&user=' + document.getElementById('email').value, '_blank');
    }

    $("#phoneNumber").CcPicker({
        dataUrl: "/js/data.json"
    });
</script>